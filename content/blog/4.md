---
title: "phpのnull合体演算子について"
published: true
date: 2025-12-12
tags:
  - php
---

## 不思議に思ったこと

以下のコードが実行された時、`$user->name`で例外となり2行目でエラーが発生すると思っていた。

```php
$user = null;
$name = $user->name ?? null;
```

しかし、実際には例外は発生せず、`$name = null`の状態で次の処理に進む。

> [!HELP] 疑問
> `$user->name ?? null;`のような「null合体演算子」では、
> なぜ`$user->name`での例外をthrowしないで済むのか...?

## 調べてみた

> 式 `(expr1) ?? (expr2)` は、 `expr1` が `null` である場合は `expr2` と評価され、それ以外の場合は `expr1` と評価されます。
> この演算子は、左側の値が存在しない場合でも `notice` や `warning` が発生しません。 `isset()` と同じ挙動です。 これは、配列のキーを扱う場合に便利です。
>
> ※ 参考: [比較演算子 - php公式](https://www.php.net/manual/ja/language.operators.comparison.php)

「左側の値（式1）が `null` かどうか」を評価して結果を返すので、
`$user = null` である → `$user->name = null` である という評価をしているようです。

## 注意したい点

1. 厳密に `null` を評価する

式1が `null` ではなく `false` や `''` だった場合、式1を結果として返す

```php
$val = '';
$result = $val ?? 'NULL';   // 結果: ''

```

2. 使えるのは `PHP 7.0` 以降
